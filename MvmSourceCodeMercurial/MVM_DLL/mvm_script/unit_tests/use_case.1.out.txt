(
  define_type
    (
      shopping_cart
    )
    (
      as
        (
          items
          item
            [
              (
              )
            ]
        )
      as
        (
          grand_total
          decimal
        )
    )
  define_type
    (
      item
    )
    (
      sku
        (
          string
          MyStaticMetaInfo => "something"
        )
      as
        (
          description
          string
        )
      as
        (
          quantity
          int
        )
      as
        (
          unit_price
          decimal
        )
      total
        (
          decimal
        )
    )
  proc
    (
      name
        (
          test_case
        )
      arguments
        (
        )
    )
    {
      =
        (
          cart
          shopping_cart
            (
            )
        )
      cart
        .(
          buy_stuff
            (
            )
        )
      =
        (
          my_grand_total
          cart
            .(
              checkout
                (
                )
            )
        )
      print
        (
          ~
            (
              'grand total is '
              my_grand_total
            )
        )
    }
  proc
    (
      name
        (
          buy_stuff
        )
      arguments
        (
        )
    )
    {
      items
        .(
          Add
            (
              item
                (
                  sku => 'floss'
                  description => 'use daily'
                  quantity => 2
                  unit_price => 1.99
                )
            )
        )
      items
        .(
          Add
            (
              item
                (
                  sku => 'tooth paste'
                  description => 'minty'
                  quantity => 1
                  unit_price => 4.00
                )
            )
        )
    }
  proc
    (
      name
        (
          checkout
        )
      arguments
        (
        )
      returns
        (
          decimal
        )
    )
    {
      items
        .(
          ForEach
            (
              =
                (
                  total
                  *
                    (
                      unit_price
                      quantity
                    )
                )
            )
        )
      =
        (
          grand_total
          items
            .(
              Sum
                (
                  total
                )
            )
        )
    }
)
